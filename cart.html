<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Giỏ hàng</title>
    <link rel="stylesheet" href="stylecart.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

</head>

<body>
    <h2>Giỏ hàng của bạn</h2>
    <div id="cart-container"></div>
    <h3 id="total"></h3>
    <button id="checkout">Thanh toán</button>

    <!-- Thông báo -->
    <div id="toast"></div>

    <script src="cart.js"></script>
    <script>
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        let container = document.getElementById("cart-container");
        let total = 0;

        if (cart.length === 0)
        {
            container.innerHTML = "<p>Giỏ hàng trống.</p>";
        } else
        {
            cart.forEach((item, index) =>
            {
                let div = document.createElement("div");
                div.innerHTML = `
          <img src="${item.image}" width="50">
          <b>${item.name}</b> - ${item.price} x ${item.quantity}
          <button onclick="removeItem(${index})">Xóa</button>
        `;
                container.appendChild(div);

                // Tính tổng
                let priceNum = parseInt(item.price.replace(/[^\d]/g, ""));
                total += priceNum * item.quantity;
            });
            document.getElementById("total").innerText = "Tổng: " + total.toLocaleString("vi-VN") + "₫";
        }

        // Xóa sản phẩm
        function removeItem(i)
        {
            cart.splice(i, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            location.reload();
        }

        // Hàm hiển thị thông báo
        function showToast(message, type = "success")
        {
            let toast = document.getElementById("toast");
            toast.innerHTML =
                type === "success"
                    ? `<i class="fa-solid fa-circle-check"></i> ${message}`
                    : `<i class="fa-solid fa-circle-xmark"></i> ${message}`;

            toast.className = `show ${type}`;

            // Ẩn sau 3 giây
            setTimeout(() =>
            {
                toast.className = toast.className.replace(`show ${type}`, "");
            }, 3000);
        }

        // Thanh toán
        document.getElementById("checkout").addEventListener("click", () =>
        {
            if (cart.length > 0)
            {
                showToast("Thanh toán thành công! Cảm ơn bạn đã mua hàng.", "success");
                localStorage.removeItem("cart");
                setTimeout(() => location.reload(), 1500);
            } else
            {
                showToast("Chưa có sản phẩm nào để thanh toán!", "error");
            }
        });
    </script>
</body>

</html>